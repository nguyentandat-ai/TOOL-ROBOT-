<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width,initial-scale=1" name="viewport">
    <title>LUKZANMODZ - DELAY ANALYZING</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; user-select:none; }
        body { font-family: 'Roboto', sans-serif; background:#000; overflow:hidden; height:100vh; width:100vw; }
        iframe { width: 100vw; height: 100vh; border: none; position: fixed; top: 0; left: 0; z-index: 1; }

        #lukzan-root {
            position: fixed; top: 150px; left: 20px;
            z-index: 9999999; display: flex; align-items: center; 
            touch-action: none; cursor: move;
        }

        .robot-icon {
            width: 85px; height: auto;
            margin-right: -15px; z-index: 10;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.5));
            animation: bounce 1.5s infinite;
        }

        .frosted-panel {
            background: rgba(255, 255, 255, 0.18);
            backdrop-filter: blur(15px) saturate(180%);
            -webkit-backdrop-filter: blur(15px) saturate(180%);
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 20px; 
            padding: 12px 25px 12px 35px;
            box-shadow: 0 15px 45px rgba(0, 0, 0, 0.7);
            min-width: 280px;
        }

        .text-row { 
            color: #ffffff; 
            font-size: 20px; 
            line-height: 1.8;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            white-space: nowrap;
        }

        #prediction-content { transition: 0.3s; }
        .analyzing { color: #ffcc00; animation: blink 0.6s infinite; }
        .val-result { color: #00ff88; text-transform: uppercase; }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    </style>
</head>
<body>

<iframe src="https://lc79b.bet/"></iframe>

<div id="lukzan-root">
    <img src="https://files.catbox.moe/u9pf9n.gif" class="robot-icon" alt="Bot">
    <div class="frosted-panel">
        <div class="text-row">#phiên : <span id="session-id">-------</span></div>
        <div class="text-row">Dự đoán : <span id="prediction-content">ĐANG QUÉT...</span></div>
    </div>
</div>

<script>
    // --- DRAG SYSTEM ---
    const dragRoot = document.getElementById("lukzan-root");
    let isDragging = false, startX, startY, initialX, initialY;
    
    document.onmousedown = document.ontouchstart = (e) => {
        isDragging = true;
        const c = e.touches ? e.touches[0] : e;
        startX = c.clientX; startY = c.clientY;
        initialX = dragRoot.offsetLeft; initialY = dragRoot.offsetTop;
    };
    document.onmousemove = document.ontouchmove = (e) => {
        if(!isDragging) return;
        const c = e.touches ? e.touches[0] : e;
        dragRoot.style.left = (initialX + (c.clientX - startX)) + "px";
        dragRoot.style.top = (initialY + (c.clientY - startY)) + "px";
    };
    document.onmouseup = document.ontouchend = () => isDragging = false;

    // --- LOGIC DELAY ANALYZING ---
    let lastProcessedSession = ""; 
    let isAnalyzing = false;

    async function updateRobot() {
        const sessionEl = document.getElementById("session-id");
        const predictEl = document.getElementById("prediction-content");
        
        const renderApi = 'https://lc79-byck.onrender.com/lc79/md5';
        const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(renderApi)}&t=${Date.now()}`;

        try {
            const response = await fetch(proxyUrl);
            const result = await response.json();
            const data = JSON.parse(result.contents);

            if (data && data.phien) {
                let apiSession = data.phien; 
                let gameSession = (parseInt(apiSession) + 1).toString(); 

                // Luôn cập nhật phiên game trên màn hình
                sessionEl.innerText = gameSession;

                // NẾU PHÁT HIỆN SANG PHIÊN MỚI (VÀ CHƯA ĐANG TRONG QUÁ TRÌNH PHÂN TÍCH)
                if (gameSession !== lastProcessedSession && !isAnalyzing) {
                    lastProcessedSession = gameSession;
                    isAnalyzing = true;

                    // HIỆN THÔNG BÁO ĐANG PHÂN TÍCH TRONG 2.5 GIÂY
                    predictEl.innerText = "Đang phân tích...";
                    predictEl.className = "analyzing";

                    setTimeout(() => {
                        // SAU 2.5 GIÂY THÌ MỚI HIỆN KẾT QUẢ TỪ API
                        predictEl.innerHTML = `<span class="val-result">${data.du_doan}</span>`;
                        predictEl.className = ""; // Bỏ hiệu ứng nhấp nháy
                        isAnalyzing = false;
                    }, 2500); // Khoảng thời gian 2-3s mày muốn đây
                }
            }
        } catch (e) {
            console.log("Syncing...");
        }
    }

    // Quét liên tục để bắt nhịp game nhanh nhất
    setInterval(updateRobot, 1000);
    updateRobot();
</script>
</body>
</html>
